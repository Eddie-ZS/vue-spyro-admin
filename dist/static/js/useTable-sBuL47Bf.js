var s=(r,o,a)=>new Promise((i,l)=>{var f=t=>{try{n(a.next(t))}catch(e){l(e)}},c=t=>{try{n(a.throw(t))}catch(e){l(e)}},n=t=>t.done?i(t.value):Promise.resolve(t.value).then(f,c);n((a=a.apply(r,o)).next())});import{E as g,C as p,W as y,z as m,_ as b,J as d,y as h}from"./.pnpm-D59sYBvj.js";const w=()=>({confirmApi:o=>{const{message:a="",type:i="warning",draggable:l=!1}=o;return new Promise(f=>{g.confirm(`是否${a}?`,"温馨提示",{confirmButtonText:"确 认",cancelButtonText:"取 消",type:i,draggable:l}).then(()=>s(void 0,null,function*(){if(o.fetchApi){const c=yield o.fetchApi(o.params);f(c)}p({type:"success",message:`${a}成功!`})}))})}}),C=r=>{const{immediate:o=!0}=r,a=y({loading:!1,data:[],total:0}),i=m(),l=m(),f=({soRef:t,elRef:e})=>{i.value=t,l.value=e},c=()=>s(void 0,null,function*(){yield h();const t=d(i);return t||console.error("表格实例不存在，请检查表格是否挂载完成"),t}),n={getList:()=>s(void 0,null,function*(){if(r.fetchApi){a.loading=!0;try{const{total:t,data:e}=yield r.fetchApi();a.data=e,a.total=t,n.setProps({tableData:e,pageProps:{total:t}})}catch(t){console.error("fetchApi error",t)}finally{a.loading=!1}}}),setProps:t=>s(void 0,null,function*(){const e=yield c();e==null||e.setProps(t)}),addColumn:(t,e)=>s(void 0,null,function*(){const u=yield c();u==null||u.addColumn(t,e)}),delColumn:t=>s(void 0,null,function*(){const e=yield c();e==null||e.delColumn(t)}),getElTableInstance:()=>s(void 0,null,function*(){return yield c(),d(l)}),refresh:()=>s(void 0,null,function*(){yield n.getList()}),delData:t=>s(void 0,null,function*(){yield w().confirmApi({fetchApi:r.fetchDelApi,params:t,message:"删除选中数据"}),n.getList()})};return b(()=>{o&&n.getList()}),{tableMount:f,tableMethods:n,tableState:a}};export{C as u};
