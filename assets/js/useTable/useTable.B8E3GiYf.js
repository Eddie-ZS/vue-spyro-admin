import{ao as d,a as p}from"../index-rMf0NY0l.js";import{ax as g,w as u,H as y,C as m,v as w}from"../.pnpm/.pnpm.BC4ss2vt.js";const b=()=>({confirmApi:s=>{const{message:e="",type:c="warning",draggable:l=!1}=s;return new Promise(i=>{d.confirm(`是否${e}?`,"温馨提示",{confirmButtonText:"确 认",cancelButtonText:"取 消",type:c,draggable:l}).then(async()=>{if(s.fetchApi){const n=await s.fetchApi(s.params);i(n)}p({type:"success",message:`${e}成功!`})})})}}),T=o=>{const{immediate:s=!0}=o,e=g({loading:!1,data:[],total:0}),c=u(),l=u(),i=({soRef:t,elRef:a})=>{c.value=t,l.value=a},n=async()=>{await w();const t=m(c);return t||console.error("表格实例不存在，请检查表格是否挂载完成"),t},r={getList:async()=>{if(o.fetchApi){e.loading=!0;try{const{total:t,data:a}=await o.fetchApi();e.data=a,e.total=t,r.setProps({tableData:a,pageProps:{total:t}})}catch(t){console.error("fetchApi error",t)}finally{e.loading=!1}}},setProps:async t=>{const a=await n();a==null||a.setProps(t)},addColumn:async(t,a)=>{const f=await n();f==null||f.addColumn(t,a)},delColumn:async t=>{const a=await n();a==null||a.delColumn(t)},getElTableInstance:async()=>(await n(),m(l)),refresh:async()=>{await r.getList()},delData:async t=>{await b().confirmApi({fetchApi:o.fetchDelApi,params:t,message:"删除选中数据"}),r.getList()}};return y(()=>{s&&r.getList()}),{tableMount:i,tableMethods:r,tableState:e}};export{T as u};
