import{aA as d,r as m,f as p,R as u,n as g}from"../.pnpm/.pnpm.BjW_VwSY.js";import{bb as b,a6 as y}from"../index-DUoOxhq0.js";import"../Icon.vue_vue_type_script_lang/Icon.vue_vue_type_script_lang.oLLe5qt2.js";const h=()=>({confirmApi:s=>{const{message:e="",type:c="warning",draggable:i=!1}=s;return new Promise(l=>{b.confirm(`是否${e}?`,"温馨提示",{confirmButtonText:"确 认",cancelButtonText:"取 消",type:c,draggable:i}).then(async()=>{if(s.fetchApi){const n=await s.fetchApi(s.params);l(n)}y({type:"success",message:`${e}成功!`})})})}}),x=o=>{const{immediate:s=!0}=o,e=d({loading:!1,data:[],total:0}),c=m(),i=m(),l=({soRef:t,elRef:a})=>{c.value=t,i.value=a},n=async()=>{await g();const t=u(c);return t||console.error("表格实例不存在，请检查表格是否挂载完成"),t},r={getList:async()=>{if(o.fetchApi){e.loading=!0;try{const{total:t,data:a}=await o.fetchApi();e.data=a,e.total=t,r.setProps({tableData:a,pageProps:{total:t}})}catch(t){console.error("fetchApi error",t)}finally{e.loading=!1}}},setProps:async t=>{const a=await n();a==null||a.setProps(t)},addColumn:async(t,a)=>{const f=await n();f==null||f.addColumn(t,a)},delColumn:async t=>{const a=await n();a==null||a.delColumn(t)},getElTableInstance:async()=>(await n(),u(i)),refresh:async()=>{await r.getList()},delData:async t=>{await h().confirmApi({fetchApi:o.fetchDelApi,params:t,message:"删除选中数据"}),r.getList()}};return p(()=>{s&&r.getList()}),{tableMount:l,tableMethods:r,tableState:e}};export{x as u};
